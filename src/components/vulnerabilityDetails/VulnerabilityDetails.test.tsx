import React from 'react';
import { render, screen } from '@testing-library/react';
import '@testing-library/jest-dom';
import VulnerabilityDetails from './VulnerabilityDetails';
import type { Vulnerability } from '@/type';
import TestWrapper from '@/utils/test-utils';

// Mock Vulnerability data
const mockVulnerability: Vulnerability = {
  oid: 'CVE-2021-1234',
  name: 'Sample Vulnerability',
  severity: 'High',
  solutionType: 'Patch',
  qod: '30',
  assetId: '1',
};

describe('VulnerabilityDetails Component', () => {
  test('renders vulnerability details correctly', () => {
    render(
      <TestWrapper>
        <VulnerabilityDetails vulnerability={mockVulnerability} />
      </TestWrapper>
    );

    // Check if the component renders the details correctly
    expect(screen.getByText('Vulnerability Details')).toBeInTheDocument();
    expect(
      screen.getByText(`Oid: ${mockVulnerability.oid}`)
    ).toBeInTheDocument();
    expect(
      screen.getByText(`Name: ${mockVulnerability.name}`)
    ).toBeInTheDocument();
    expect(
      screen.getByText(`Severity: ${mockVulnerability.severity}`)
    ).toBeInTheDocument();
    expect(
      screen.getByText(`Description: ${mockVulnerability.solutionType}`)
    ).toBeInTheDocument();
  });
});
