import VulnerabilityDetails from '@/components/vulnerabilityDetails/VulnerabilityDetails';
import type { Vulnerability } from '@/type';
import { Center, Loader } from '@mantine/core';
import { useRouter } from 'next/router';
import { useEffect } from 'react';
import { useState } from 'react';

const VulnerabilityDetailsPage: React.FC = () => {
  const { query } = useRouter();
  const [vulnerabilityDetails, setVulnerabilityDetails] =
    useState<Vulnerability>({} as Vulnerability);
    const [loading, setLoading] = useState(true);
  useEffect(() => {
    if (query) {
      const vulnerability: Vulnerability = {
        oid: query.oid as string,
        name: query.name as string,
        severity: query.severity as string,
        assetId: query.assetId as string,
        qod: query.qod as string,
        solutionType: query.solutionType as string,
      };
      setVulnerabilityDetails(vulnerability);
      setLoading(false);
    }
  }, [query]);

  if(loading ){
    return <Center><Loader color="indigo"/></Center>
  }

  return <VulnerabilityDetails vulnerability={vulnerabilityDetails}/>;
};

export default VulnerabilityDetailsPage;
